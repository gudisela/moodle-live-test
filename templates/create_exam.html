<!doctype html>
<html>
<head>
  <meta charset="utf-8"><title>Create Exam</title>
  <style>
    body{font-family:Arial;margin:16px}
    .qblock{border:1px solid #ccc;padding:10px;margin:10px 0}
    .actions{margin-top:12px}
  </style>
</head>
<body>
  <h2>Create Exam</h2>
  <form id="examForm" method="post" action="/teacher/save_exam" enctype="multipart/form-data">
    <label>Exam ID (optional): <input name="exam_id"></label><br>
    <label>Title: <input name="title" required></label><br>
    <label>Created by: <input name="created_by"></label><br><br>

    <div id="questionsContainer"></div>

    <input type="hidden" name="q_count" id="q_count" value="0">
    <div class="actions">
      <button type="button" id="addQ">Add Question</button>
      <button type="submit">Save Exam</button>
    </div>
  </form>

<script>
let qIndex = 0;
const container = document.getElementById('questionsContainer');
document.getElementById('addQ').addEventListener('click', addQuestion);
function addQuestion(){
  qIndex++;
  const html = `
  <div class="qblock" id="qblock_${qIndex}">
    <h3>Question ${qIndex}</h3>
    <label>Question ID: <input name="q${qIndex}_id" value="q${qIndex}"></label><br>
    <label>Marks: <input name="q${qIndex}_marks" value="4" size="4"></label><br>
    <label>Instruction: <input name="q${qIndex}_instruction" size="60"></label><br>
    <label>Model answer: <input name="q${qIndex}_model" size="60"></label><br>
    <label>Question image: <input name="q${qIndex}_question" type="file" accept="image/*" required></label><br>
    <label>Diagram image (optional): <input name="q${qIndex}_diagram" type="file" accept="image/*"></label><br>
    <button type="button" onclick="removeQ(${qIndex})">Remove</button>
  </div>`;
  container.insertAdjacentHTML('beforeend', html);
  document.getElementById('q_count').value = qIndex;
}
function removeQ(i){
  const el = document.getElementById('qblock_'+i);
  if (!el) return;
  el.remove();
  // Note: does not renumber q_count; creating new ones increments index - OK
}
</script>
</body>
</html>
